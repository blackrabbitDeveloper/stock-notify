# 🚀 Stock Notify Bot 업그레이드 완료

## 📋 변경 사항 요약

기존의 뉴스 감성 분석 중심 봇을 **기술적 분석 기반 단기 매매 추천 봇**으로 강화했습니다.

---

## ✨ 새로 추가된 기능

### 1. 기술적 분석 모듈 (`src/technical_analyzer.py`)

#### 이동평균선 분석
- SMA (Simple Moving Average): 5, 10, 20, 50일
- EMA (Exponential Moving Average)
- 골든크로스/데드크로스 자동 감지
- 이평선 정배열 확인
- 현재가 대비 괴리율 계산

#### 모멘텀 지표
- **RSI (Relative Strength Index)**
  - 과매수(>70) / 과매도(<30) 구간 자동 판별
  - 14일 기준
  
- **MACD (Moving Average Convergence Divergence)**
  - MACD Line, Signal Line, Histogram 계산
  - 상향/하향 크로스 자동 감지
  - 12/26/9 표준 설정

- **볼린저 밴드 (Bollinger Bands)**
  - 상단/중간/하단 밴드 계산
  - 현재가 위치 (0~1 스케일)
  - 밴드 스퀴즈 감지

#### 변동성 & 추세 지표
- **ATR (Average True Range)**: 변동성 측정
- **ADX (Average Directional Index)**: 추세 강도 측정 (>25면 강한 추세)

#### 거래량 분석
- 20일 평균 거래량 대비 배수 계산
- 가격 상승 + 거래량 증가 동반 여부 확인

---

### 2. 점수 체계 개선

#### 기술적 분석 점수 (0~10점)
```python
골든크로스:           +2.5점
이평선 정배열:         +1.5점
MACD 상향돌파:        +1.8점
거래량 동반 상승:      +2.0점
RSI 과매도 탈출(30-50): +1.2점
볼린저밴드 하단 반등:   +1.0점
MACD 히스토그램 양수:  +0.5점
강한 추세(ADX>25):    +0.8점
적정 이평선 괴리율:     +0.5점
```

#### 최종 종합 점수
```
최종 점수 = (기술적 분석 점수 × 0.7) + (뉴스 점수 × 0.5)
```
- 기술적 분석에 70% 가중치 (단기 매매 특성)
- 뉴스 감성에 30% 가중치 (보조 지표)

---

### 3. Discord 출력 강화

각 추천 종목에 대해 다음 정보를 제공:

#### 기존 정보
- 티커, 가격, 수익률, 거래량
- 뉴스 하이라이트
- AI 추천 사유

#### 신규 추가
- 📈 기술적 분석 신호
  - 골든/데드크로스
  - 이평선 정배열
  - RSI 상태
  - MACD 신호
  - 볼린저밴드 위치
  - 거래량 상태
  - 추세 강도
- ⭐ 기술적 분석 점수 (0~10)
- 이모지로 시각적 구분 강화

---

### 4. AI 설명 강화 (`src/ai_explainer.py`)

Gemini API에 전달되는 프롬프트에 기술적 분석 정보 추가:
- 모든 기술적 지표 요약
- 매매 신호 설명
- 단기 매매 관점의 종합 분석

---

### 5. 가격 데이터 확장 (`src/fetch_prices.py`)

기존 Close, Volume에서 확장:
- **High**: 일중 최고가 (ATR, 볼린저밴드 계산용)
- **Low**: 일중 최저가 (ATR 계산용)

---

## 📊 실전 활용 가이드

### 추천 매매 전략

#### 강력한 매수 신호 (점수 7.0 이상)
```
✅ 골든크로스 발생
✅ MACD 상향돌파
✅ 거래량 2배 이상 급증
✅ RSI 30~50 (과매도 탈출)
✅ 이평선 정배열
```

#### 주의 신호 (점수 3.0 미만)
```
❌ 데드크로스 발생
❌ MACD 하향돌파
❌ RSI 70 이상 (과매수)
❌ 거래량 없는 상승
```

### 손절 원칙
단기 매매이므로 **반드시 손절가 설정**:
- 진입가 대비 -3% ~ -5% 손절
- ATR의 2배 이하로 손절폭 설정

### 목표가 설정
- 볼린저밴드 상단 도달 시 일부 익절
- 기술적 저항선 근처에서 분할 익절
- 보유 기간: 1~5일 (단기)

---

## 🧪 테스트 방법

### 1. 단일 종목 상세 분석
```bash
python test_technical.py AAPL
```

출력 예시:
```
📊 AAPL 기술적 분석 테스트
─────────────────────────────
💰 가격 정보
현재가: $175.50
전일가: $172.30
등락률: +1.86%

📈 이동평균선
5일 MA:  $173.20 (괴리율: +1.33%)
10일 MA: $171.80
20일 MA: $170.50 (괴리율: +2.93%)

🎯 매매 신호
  • 🟢 골든크로스 발생!
  • ✅ 이평선 정배열
  • 💪 가격 상승 + 거래량 급증

⭐ 기술적 분석 종합 점수: 8.2 / 10.0
💚 매수 고려 구간 (강한 신호)
```

### 2. 여러 종목 비교
```bash
python test_technical.py
```

---

## 📁 수정된 파일 목록

### 새로 생성된 파일
1. `src/technical_analyzer.py` - 기술적 분석 핵심 로직
2. `test_technical.py` - 테스트 스크립트
3. `UPGRADE_SUMMARY.md` - 이 문서

### 수정된 파일
1. `src/ranker.py` - 기술적 분석 통합, 점수 체계 변경
2. `src/fetch_prices.py` - High/Low 데이터 추가
3. `src/main.py` - 기술적 분석 정보 전달
4. `src/send_discord.py` - 기술적 신호 출력, 이모지 강화
5. `src/ai_explainer.py` - 프롬프트에 기술적 분석 포함
6. `README.md` - 전체 문서 업데이트

---

## 🎯 핵심 개선 포인트

### Before (기존)
- 뉴스 감성 + 단순 가격/거래량 기반
- 점수: 수익률 + 거래량 + 뉴스
- 중장기 관점

### After (개선)
- **기술적 분석 70% + 뉴스 30%**
- 10가지 이상의 기술적 지표 활용
- 매매 신호 자동 감지
- **단기 매매 특화** (1~5일)
- 시각적으로 강화된 Discord 출력

---

## ⚠️ 주의사항

### 반드시 지켜야 할 원칙
1. **손절가 설정 필수** (진입가 -3~5%)
2. **단기 전략**이므로 장기 보유 금지
3. **분할 매수/매도** 권장
4. **거래량 확인** 필수 (유동성)
5. **시장 상황** 고려 (변동성 확대 시 진입 자제)

### 봇의 한계
- 뉴스/공시 등 펀더멘털 한계
- 급격한 시장 변동 대응 불가
- 기술적 분석은 확률적 도구
- **100% 수익 보장 불가**

---

## 🚀 향후 개선 가능 방향

1. **백테스팅 모듈** 추가
   - 과거 데이터로 전략 검증
   - 승률, 손익비 통계

2. **더 많은 지표** 추가
   - Stochastic Oscillator
   - Williams %R
   - On-Balance Volume (OBV)

3. **패턴 인식**
   - Head & Shoulders
   - Double Top/Bottom
   - Triangle patterns

4. **실시간 알림**
   - 골든크로스 발생 즉시 알림
   - 손절가 도달 알림

5. **포트폴리오 관리**
   - 진입/청산 추적
   - 수익률 계산

---

## 📞 문의 및 피드백

이슈나 개선 제안은 GitHub Issues를 통해 남겨주세요!

**면책**: 이 도구는 교육 및 참고용입니다. 투자 손실의 책임은 본인에게 있습니다.
